<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chi tiết phim </title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
          integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <link rel="stylesheet" th:href="@{/web-assets/css/style.css}">


    <style>
        .movie-poster {
            position: relative;
        }

        .play-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            color: white;
            cursor: pointer;
            z-index: 10;
            transition: transform 0.3s ease, color 0.3s ease;
        }

        .play-icon:hover {
            transform: translate(-50%, -50%) scale(1.2);
            color: #ff0000;
        }

        textarea::placeholder {
            color: #6c757d;
            font-style: italic;
        }

        .modal-dialog {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 70%;
        }

        .modal-dialog.modal-lg {
            max-width: 50%;
        }

        .modal-footer {
            display: flex;
            justify-content: center;
        }

        #completeReview {
            width: 200px;
            text-align: center;
        }

        /* Đặt màu xám cho các sao */
        #rating .fa-star {
            color: rgb(204, 204, 204); /* Màu xám */
        }

        /* Thay đổi màu sao khi di chuột qua */
        #rating .fa-star:hover {
            color: #FFD43B; /* Màu vàng khi di chuột qua */
        }
    </style>

</head>
<body>
<header class="bg-dark">
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="https://motchilltv.vc/_ipx/f_webp&s_150x35/logo.png" alt="" class="logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-link text-white" href="/">Trang chủ</a>
                    <a class="nav-link text-white" href="/phim-bo">Phim bộ</a>
                    <a class="nav-link text-white" href="/phim-le">Phim lẻ</a>
                    <a class="nav-link text-white" href="/phim-chieu-rap">Phim chiếu rạp</a>
                    <a class="nav-link text-white" >Quốc gia</a>
                    <a class="nav-link text-white" >Thể loại</a>
                    <a class="nav-link text-white" href="/tin-tuc" >Blog</a>
                </div>

                <div>
                    <a class="text-white" href="#">Đăng nhập</a>
                </div>
            </div>
        </div>
    </nav>
</header>

<section class="py-4">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a class="text-primary" href="/">Trang chủ</a></li>
                <li class="breadcrumb-item"><a class="text-primary" href="/phim-bo">Phim bộ</a></li>
                <li class="breadcrumb-item active" aria-current="page" th:text="${movie.name}">Nhím Sonic 2</li>
            </ol>
        </nav>
        <div class="row mt-4">
            <div class="col-3">
                <div class="movie-poster overflow-hidden position-relative rounded">
                    <img
                            id="movie-poster"
                            class="w-100"
                            th:src="${movie.poster}"
                            th:alt="${movie.name}"
                    >
                    <span class="play-icon" data-bs-toggle="modal" data-bs-target="#modal-trailer">
                        <i class="fa-regular fa-circle-play"></i>
                    </span>
                </div>
            </div>
            <div class="col-9">
                <div class="d-flex align-items-center mb-3">
                    <h4 class="mb-0" th:text="${movie.name}">Nhím Sonic 2</h4>
                    <div class="d-flex align-items-center bg-body-tertiary p-1 rounded ms-2">
                        <span class="fw-bold me-1" th:text="${movie.rating}">10</span>
                        <span class="rating-icon text-yellow-300"><i class="fas fa-star" style="color: #FFD43B;"></i></span>
                    </div>
                </div>
                <div class="p-3 bg-body-tertiary">
                    <div class="row">
                        <div class="col-2"><p>Thể loại</p></div>
                        <div class="col-10">
                            <th:block th:each="genres, iterStat : ${movie.genres}">
                                <span th:text="${genres.name}"></span>
                                <span th:if="${!iterStat.last}">, </span>
                            </th:block>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2"><p>Năm sản xuất</p></div>
                        <div class="col-10"><p th:text="${movie.releaseYear}">2022</p></div>
                    </div>
                    <div class="row">
                        <div class="col-2"><p>Quốc gia</p></div>
                        <div class="col-10">
                            <p>
                                <span th:each="country : ${movie.country}" th:text="${country.name}">Mỹ</span>
                            </p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2"><p>Đạo diễn</p></div>
                        <div class="col-10">
                            <th:block th:each="director, iterStat : ${movie.directors}">
                                <span th:text="${director.name}"></span>
                                <span th:if="${!iterStat.last}">, </span>
                            </th:block>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2"><p>Diễn viên</p></div>
                        <div class="col-10">
                            <th:block th:each="actor, iterStat : ${movie.actors}">
                                <span th:text="${actor.name}"></span>
                                <span th:if="${!iterStat.last}">, </span>
                            </th:block>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-2"><p>Nội dung phim</p></div>
                        <div class="col-10"><p th:text="${movie.description}">Khi Robotnik tìm cách quay trở về Trái Đất
                            thành công, ông ta có một đồng
                            minh mới là Knuckles hùng mạnh, liệu Sonic và người bạn ới Tails có thể ngăn&nbsp;<span
                                    class="text-primary">Xem thêm</span></p></div>
                    </div>
                </div>
                <div>
                    <div class="d-flex align-items-center"><a
                            class="d-inline-block btn btn-danger px-5 py-2 mt-3 rounded me-2"
                            href="/xem-phim/116/nhim-sonic-2?tap=full"><span class="me-1"><i
                            class="fa-solid fa-play"></i></span>Xem phim</a>
                        <div id="btn-wishlist-container">
                            <button class="d-inline-block btn bg-dark px-5 py-2 mt-3 rounded text-white"><span
                                    class="me-1"><i class="fa-solid fa-heart"></i></span>Thêm vào yêu thích
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <h4 class="mb-3">Tập phim</h4>
               <th:block th:each="episode : ${episodes}">
                    <a class="btn btn-dark me-2"
                            th:href="|/phim/${movieId}/${movie.id}/${episode.id}|"
                       th:text="'Tập ' + ${episode.displayOrder}"></a>
               </th:block>
         </div>
        </div>
    </div>
</section>

<section class="py-4 bg-body-secondary">
    <div class="container">
        <h3>Phim đề xuất</h3>
        <div class="row">
            <div class="col-2" th:each="movie : ${recommendMovies}">
                <a th:href="|/phim/${movie.id}/${movie.slug}|" class="movie-item text-black text-decoration-none">
                    <div class="movie-poster rounded overflow-hidden">
                        <img th:src="${movie.poster}" th:alt="${movie.name}">
                    </div>
                    <div class="movie-info">
                        <p class="mt-2" th:text="${movie.name}">Lọ lem 2 giờ sáng</p>
                    </div>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Modal cho nút Viết bình luận -->
<div class="modal fade" id="reviewModal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="reviewModalLabel">Đánh giá phim</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="reviewForm">
                    <div class="mb-3 text-center">
                        <h5 th:text="${movie.name}">Iron Man: Hủy Diệt</h5>
                        <div id="rating" class="d-fle justify-content-center">
                            <i class="fa-solid fa-star" data-rating="1" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="2" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="3" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="4" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="5" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="6" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="7" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="8" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="9" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                            <i class="fa-solid fa-star" data-rating="10" style="color: rgb(204, 204, 204); cursor: pointer;"></i>
                        </div>
                        <input type="hidden" id="ratingValue" name="rating" value="0">
                    </div>
                    <div id="ratingDisplay" class="fw-bold text-center mt-3">Bạn chưa đánh giá</div>
                    <div class="mb-3">
                        <textarea class="form-control" id="comment" rows="5" placeholder="Hãy nêu cảm nhận của bạn về bộ phim" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer d-fle justify-content-center">
                <button type="button" class="btn btn-primary" id="completeReview">Hoàn tất</button>
            </div>
        </div>
    </div>
</div>

<section class="py-4 bg-body-tertiary">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center">
            <h3>Bình luận</h3>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reviewModal">
                Viết bình luận
            </button>
        </div>
        <div>
            <span>Vui lòng</span>
            <a href="">đăng nhập</a>
            <span>để viết bình luận</span>
        </div>

        <th:block th:each="review : ${reviews}">
            <div class="row py-3">
                <div class="col-1 d-flex flex-column align-items-center justify-content-between">
                        <div>
                            <img class="ava rounded-circle" th:src="${review.getUser().getAvatar()}">
                        </div>
                </div>

                <div class="col">
                    <div>
                        <span class="fw-bold" th:text="${review.getUser().name}">Lê Hải Dũng</span>
                        <span class="fw-light" th:text="${#temporals.format(review.createdAt, 'dd-MM-yyyy')}">20/02/2022</span>
                        <div>
                            <span th:text="${review.getRating()}"></span>
                            <i class="fas fa-star" style="color: #FFD43B;"></i>
                            <span th:if="${review.getRating() >= 8}">Cũng hay đấy</span>
                            <span th:if="${review.getRating() >= 6 && review.getRating()<8}">Bình thường thôi</span>
                            <span th:if="${review.getRating() < 6}">Quá tệ</span>

                        </div>
                        <span class="text-black fw-light" th:text="${review.getContent()}">Nhạt như nước ốc</span>
                    </div>
                </div>
            </div>
        </th:block>
    </div>
</section>

<div class="container mt-5">
    <nav aria-label="Page navigation example">
        <ul class="pagination d-flex justify-content-center">
            <li class="page-item">
                <a class="page-link" href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            <li class="page-item"><a class="page-link" href="#">1</a></li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item">
                <a class="page-link" href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>


<footer class="py-4 bg-dark">
    <div class="container">
        <div class="row">
            <div class="col-4">
                <img src="https://motchilltv.vc/_ipx/f_webp&s_150x35/logo.png" alt="" class="logo">
                <p class="text-white mt-3">Trang web xem phim trực tuyến miễn phí chất lượng cao với giao diện trực quan,
                    tốc độ tải trang nhanh, cùng kho phim với hơn 10.000+ phim mới, phim hay, luôn cập nhật phim nhanh,
                    hứa hẹn sẽ đem lại phút giây thư giãn cho bạn.</p>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase">DANH MỤC</h5>
                    <p>Tin tức</p>
                    <p>Phim chiếu rạp</p>
                    <p>Phim lẻ</p>
                    <p>Phim bộ</p>
                    <p>TV Show</p>
                </div>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase">THỂ LOẠI </h5>
                    <p>Phim cổ trang</p>
                    <p>Phim đam mỹ</p>
                    <p>Phim bách hợp</p>
                    <p>Phim viễn tưởng</p>
                    <p>Phim hoạt hình</p>
                </div>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase">ĐIỀU KHOẢN</h5>
                    <p>DMCA</p>
                    <p>Liên hệ</p>
                    <p>Privacy</p>
                    <p>Terms of Service</p>
                </div>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase">SOCIAL</h5>
                    <p>Tin tức</p>
                    <p>Phim chiếu rạp</p>
                    <p>Phim lẻ</p>
                    <p>Phim bộ</p>
                    <p>TV Show</p>
                </div>
            </div>
        </div>
    </div>
</footer>


<div class="modal fade" id="modal-trailer" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Trailer</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <iframe style="aspect-ratio: 16 / 9" width="100%" src="https://www.youtube.com/embed/MjxPoqCvvVs?si=O86GBpvOpevCw1sa"
                        title="YouTube video player" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
        </div>
    </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const myModal = document.getElementById('modal-trailer');
        const iframe = myModal.querySelector('iframe');

        myModal.addEventListener('hide.bs.modal', function () {
            const src = iframe.src;
            iframe.src = '';
            iframe.src = src;
        });
    });


    document.addEventListener('DOMContentLoaded', function() {
        const stars = document.querySelectorAll('#rating i');
        const ratingValue = document.getElementById('ratingValue');
        const ratingDisplay = document.getElementById('ratingDisplay');

        // Xử lý khi người dùng nhấp vào sao
        stars.forEach(star => {
            star.addEventListener('click', function() {
                const rating = this.getAttribute('data-rating');
                ratingValue.value = rating;
                updateStarColors(rating);
                updateRatingDisplay(rating);
            });

            // Xử lý khi di chuột qua sao
            star.addEventListener('mouseover', function() {
                const rating = this.getAttribute('data-rating');
                updateStarColors(rating, true);
            });

            // Xử lý khi di chuột ra ngoài sao
            star.addEventListener('mouseout', function() {
                const rating = ratingValue.value;
                updateStarColors(rating);
            });
        });

        // Xử lý khi người dùng nhấp vào nút "Hoàn tất"
        document.getElementById('completeReview').addEventListener('click', function() {
            const rating = ratingValue.value;
            const comment = document.getElementById('comment').value;

            if (rating > 0 && comment.trim() !== '') {
                console.log('Đánh giá:', rating);
                console.log('Bình luận:', comment);

                // Đóng modal sau khi gửi
                var modal = bootstrap.Modal.getInstance(document.getElementById('reviewModal'));
                modal.hide();
            } else {
                alert('Vui lòng chọn đánh giá và nhập bình luận.');
            }
        });

        // Cập nhật màu sắc của các sao
        function updateStarColors(rating, hover = false) {
            stars.forEach(star => {
                const starRating = parseInt(star.getAttribute('data-rating'));
                if (hover) {
                    // Nếu đang di chuột qua sao
                    if (starRating <= rating) {
                        star.style.color = '#FFD43B';
                    } else {
                        star.style.color = '#ccc';
                    }
                } else {
                    // Nếu không di chuột qua sao
                    if (starRating <= rating) {
                        star.style.color = '#FFD43B';
                    } else {
                        star.style.color = '#ccc';
                    }
                }
            });
        }

        // Cập nhật hiển thị đánh giá
        function updateRatingDisplay(rating) {
            ratingDisplay.textContent = `Bạn đã đánh giá ${rating}/10`;
        }
    });
</script>
</body>
</html>